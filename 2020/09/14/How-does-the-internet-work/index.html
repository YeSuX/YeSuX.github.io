<!DOCTYPE html>
<html lang="en">
    <head>
    <meta charset="utf-8">

    

    <!-- 渲染优化 -->
    <meta name="renderer" content="webkit">
    <meta name="force-rendering" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="HandheldFriendly" content="True" >
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

    <!--icon-->

    <link rel="shortcut icon" type='image/x-icon' href="/futuristic_s.png">


    <!-- meta -->


<title>How does the internet work | 博客</title>


    <meta name="keywords" content="Internet">


    <!-- OpenGraph -->
 
    <meta name="description" content="如今，Internet爆发增长，每个人都躲不过www&amp;com轰炸，我们需了解它才能有效使用它。 本文介绍了Internet的基本结构和技术。虽未深入，但基本涵盖Internet各领域。 How does the Internet Work?The Internet works through a packet routing network分组路由 in accordance with根据">
<meta property="og:type" content="article">
<meta property="og:title" content="How does the internet work">
<meta property="og:url" content="https://yesux.github.io/2020/09/14/How-does-the-internet-work/index.html">
<meta property="og:site_name" content="博客">
<meta property="og:description" content="如今，Internet爆发增长，每个人都躲不过www&amp;com轰炸，我们需了解它才能有效使用它。 本文介绍了Internet的基本结构和技术。虽未深入，但基本涵盖Internet各领域。 How does the Internet Work?The Internet works through a packet routing network分组路由 in accordance with根据">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://yesux.github.io/images/Internet_1.jpg">
<meta property="article:published_time" content="2020-09-14T08:17:25.000Z">
<meta property="article:modified_time" content="2020-09-15T03:50:26.257Z">
<meta property="article:author" content="叶苏雄">
<meta property="article:tag" content="Internet">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://yesux.github.io/images/Internet_1.jpg">


    
<link rel="stylesheet" href="/css/style/main.css">
 


    
<link rel="stylesheet" href="/css/style/dark.css">

    
<script src="/js/darkmode.js"></script>



    
    
        <link rel="stylesheet" id="hl-default-theme" href="/css/highlight/default.css" media="none" onload="if(getComputedStyle(document.documentElement).getPropertyValue('--color-mode').indexOf('dark')===-1)this.media='all'">
        
            <link rel="stylesheet" id="hl-dark-theme" href="/css/highlight/dark.css" media="none" onload="if(getComputedStyle(document.documentElement).getPropertyValue('--color-mode').indexOf('dark')!==-1)this.media='all'">
        
    

    
    

    
    <link rel="stylesheet" href="/css/style/note.css" media="none" onload="this.media='all'">


     

    <!-- custom head -->

<meta name="generator" content="Hexo 5.1.1"></head>

    <body>
        <div id="app">
            <header class="header">
    <div class="header__left">
        <a href="/" class="button">
            <span class="logo__text">
                Ysx's Blog
            </span>
        </a>
    </div>
    <div class="header__right">
        
            <div class="navbar__menus">
                
                    <a href="/" class="navbar-menu button">
                        首页
                    </a>
                
                    <a href="/tags/" class="navbar-menu button">
                        标签
                    </a>
                
                    <a href="/archives/" class="navbar-menu button">
                        归档
                    </a>
                
                    <a href="/pictures/" class="navbar-menu button">
                        画廊
                    </a>
                
                    <a href="/pages/" class="navbar-menu button">
                        Page
                    </a>
                
            </div>
        
        
        

        
        
    <a href="javaScript:void(0);" id="btn-toggle-dark">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg>
    </a>


         
    <a href="javaScript:void(0);" id="b2t" aria-label="Back to Top" title="Back to Top">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width='32' height='32' fill="currentColor" stroke="currentColor" stroke-width="0.7" stroke-linecap="round" stroke-linejoin="round">
            <path d="M13.889,11.611c-0.17,0.17-0.443,0.17-0.612,0l-3.189-3.187l-3.363,3.36c-0.171,0.171-0.441,0.171-0.612,0c-0.172-0.169-0.172-0.443,0-0.611l3.667-3.669c0.17-0.17,0.445-0.172,0.614,0l3.496,3.493C14.058,11.167,14.061,11.443,13.889,11.611 M18.25,10c0,4.558-3.693,8.25-8.25,8.25c-4.557,0-8.25-3.692-8.25-8.25c0-4.557,3.693-8.25,8.25-8.25C14.557,1.75,18.25,5.443,18.25,10 M17.383,10c0-4.07-3.312-7.382-7.383-7.382S2.618,5.93,2.618,10S5.93,17.381,10,17.381S17.383,14.07,17.383,10"></path>
        </svg>
    </a>


        
            <a class="dropdown-icon button" id="btn-dropdown">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width='24' height='24' fill="none" stroke="currentColor" stroke-width="0.7" stroke-linecap="round" stroke-linejoin="round">
                    <path fill="currentColor" d="M3.314,4.8h13.372c0.41,0,0.743-0.333,0.743-0.743c0-0.41-0.333-0.743-0.743-0.743H3.314c-0.41,0-0.743,0.333-0.743,0.743C2.571,4.467,2.904,4.8,3.314,4.8z M16.686,15.2H3.314c-0.41,0-0.743,0.333-0.743,0.743s0.333,0.743,0.743,0.743h13.372c0.41,0,0.743-0.333,0.743-0.743S17.096,15.2,16.686,15.2z M16.686,9.257H3.314c-0.41,0-0.743,0.333-0.743,0.743s0.333,0.743,0.743,0.743h13.372c0.41,0,0.743-0.333,0.743-0.743S17.096,9.257,16.686,9.257z"></path>
                </svg>
            </a>
            <div class="dropdown-menus" id="dropdown-menus">
                <a class="dropback-icon button" id="btn-dropback">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width='24' height='24' fill="none" stroke="currentColor" stroke-width="0.7" stroke-linecap="round" stroke-linejoin="round">
                        <path fill="currentColor" d="M11.469,10l7.08-7.08c0.406-0.406,0.406-1.064,0-1.469c-0.406-0.406-1.063-0.406-1.469,0L10,8.53l-7.081-7.08c-0.406-0.406-1.064-0.406-1.469,0c-0.406,0.406-0.406,1.063,0,1.469L8.531,10L1.45,17.081c-0.406,0.406-0.406,1.064,0,1.469c0.203,0.203,0.469,0.304,0.735,0.304c0.266,0,0.531-0.101,0.735-0.304L10,11.469l7.08,7.081c0.203,0.203,0.469,0.304,0.735,0.304c0.267,0,0.532-0.101,0.735-0.304c0.406-0.406,0.406-1.064,0-1.469L11.469,10z"></path>
                    </svg>
                </a>
                
                    <a href="/" class="dropdown-menu button">
                        首页
                    </a>
                
                    <a href="/tags/" class="dropdown-menu button">
                        标签
                    </a>
                
                    <a href="/archives/" class="dropdown-menu button">
                        归档
                    </a>
                
                    <a href="/pictures/" class="dropdown-menu button">
                        画廊
                    </a>
                
                    <a href="/pages/" class="dropdown-menu button">
                        Page
                    </a>
                
            </div>
            <script>
                document.getElementById('btn-dropdown').addEventListener('click', () => {
                    const dd = document.getElementById('dropdown-menus');
                    requestAnimationFrame(() => {
                        dd.style.display = 'flex';
                        requestAnimationFrame(() => {
                            dd.style.transform = 'translateY(0)';
                            dd.style.opacity = '1';
                        });
                    });
                });
                document.getElementById('btn-dropback').addEventListener('click', () => {
                    const dd = document.getElementById('dropdown-menus');
                    dd.style.transform = 'translateY(2.25rem)';                    
                    dd.style.opacity = '0';
                    setTimeout(() => {dd.style.display = 'none';}, 350);
                });
            </script>
        
    </div>
</header>


            <main class="main">
    
<div class="post-title">
    <h1 class="post-title__text">
        How does the internet work
    </h1>
    <div class="post-title__meta">
        <a href="/archives/2020/09/" class="post-meta__date button">
    2020-09-14
</a>
        
 
        
    
    


 

 
    </div>
</div>


    <div class="post__with-side">
        <aside class="post-side">
            <div class="post-side__toc">
                <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#How-does-the-Internet-Work"><span class="toc-text">How does the Internet Work?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#What%E2%80%99s-a-protocol"><span class="toc-text">What’s a protocol?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#What%E2%80%99s-a-packet"><span class="toc-text">What’s a packet?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#What%E2%80%99s-a-packet-routing-network"><span class="toc-text">What’s a packet routing network?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Where-did-these-Internet-routers-come-from-Who-owns-them"><span class="toc-text">Where did these Internet routers come from? Who owns them?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Do-the-packets-always-arrive-in-order-If-not-how-is-the-message-re-assembled"><span class="toc-text">Do the packets always arrive in order? If not, how is the message re-assembled?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Do-packets-always-make-it-to-their-destination"><span class="toc-text">Do packets always make it to their destination?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#What-do-these-Internet-addresses-look-like"><span class="toc-text">What do these Internet addresses look like?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#How-can-there-be-over-8-billion-networked-devices-on-the-Internet-if-there-are-only-about-4-billion-IPv4-addresses"><span class="toc-text">How can there be over 8 billion networked devices on the Internet if there are only about 4 billion IPv4 addresses?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#How-does-the-router-know-where-to-send-a-packet-Does-it-need-to-know-where-all-the-IP-addresses-are-on-the-Internet"><span class="toc-text">How does the router know where to send a packet? Does it need to know where all the IP addresses are on the Internet?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#But-a-router-still-needs-to-know-a-lot-of-network-prefixes-If-a-new-router-is-added-to-the-Internet-how-does-it-know-how-to-handle-packets-for-all-these-network-prefixes"><span class="toc-text">But a router still needs to know a lot of network prefixes . If a new router is added to the Internet how does it know how to handle packets for all these network prefixes?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#How-do-networked-computers-figure-out-ip-addresses-based-on-domain-names"><span class="toc-text">How do networked computers figure out ip addresses based on domain names?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#How-do-applications-communicate-over-the-Internet"><span class="toc-text">How do applications communicate over the Internet?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#What-do-each-of-these-Internet-layers-do"><span class="toc-text">What do each of these Internet layers do?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#What%E2%80%99s-a-client-versus-a-server"><span class="toc-text">What’s a client versus a server?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#How-can-sensitive-data-like-credit-cards-be-transmitted-securely-over-the-Internet"><span class="toc-text">How can sensitive data like credit cards be transmitted securely over the Internet?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#What-is-SSL-TLS"><span class="toc-text">What is SSL&#x2F;TLS?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#How-does-SSL-authenticate-the-identity-of-a-server-and-encrypt-their-communication"><span class="toc-text">How does SSL authenticate the identity of a server and encrypt their communication?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#What-happens-if-a-hacker-intercepts-an-SSL-encrypted-session"><span class="toc-text">What happens if a hacker intercepts an SSL-encrypted session?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Link"><span class="toc-text">Link</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Bibliography"><span class="toc-text">Bibliography</span></a></li></ol>
            </div>
        </aside>
        <article class="post content-card">
            <div class="post__header">
                
    
        <div class="post-thumbnail lazyload" data-bg="/images/Internet_1.jpg"></div>
    
 
                
            </div>
            <div class="post__content">
                <p>如今，Internet爆发增长，每个人都躲不过www&amp;com轰炸，我们需了解它才能有效使用它。</p>
<p>本文介绍了Internet的基本结构和技术。虽未深入，但基本涵盖Internet各领域。</p>
<h3 id="How-does-the-Internet-Work"><a href="#How-does-the-Internet-Work" class="headerlink" title="How does the Internet Work?"></a>How does the Internet Work?</h3><p>The Internet works through a packet routing network<code>分组路由</code> in accordance with<code>根据</code> the <em>Internet Protocol (IP)</em>, the <em>Transport Control Protocol</em> (TCP) and other protocols.</p>
<h3 id="What’s-a-protocol"><a href="#What’s-a-protocol" class="headerlink" title="What’s a protocol?"></a>What’s a protocol?</h3><p>A protocol is a set of rules specifying<code>指定</code> how computers should communicate with each other over a network. For example, the <em>Transport Control Protocol</em> has a rule that if one computer sends data to another computer, the destination computer should let the source computer know if any data was missing so the source computer can re-send it. Or the <em>Internet Protocol</em> which specifies how computers should route information to other computers by attaching addresses onto the data it sends.</p>
<h3 id="What’s-a-packet"><a href="#What’s-a-packet" class="headerlink" title="What’s a packet?"></a>What’s a packet?</h3><p>Data sent across the Internet is called a <em>message</em>. Before a <em>message</em> is sent, it is first split in many fragments<code>切片</code> called <em>packets</em>. These <em>packets</em> are sent independently of each other. The typical maximum <em>packet</em> size is between 1000 and 3000 characters. The <em>Internet Protocol</em> specifies how messages should be packetized.</p>
<h3 id="What’s-a-packet-routing-network"><a href="#What’s-a-packet-routing-network" class="headerlink" title="What’s a packet routing network?"></a>What’s a packet routing network?</h3><p>It is a network that routes <em>packets</em> from a source computer to a destination computer. The Internet is made up of a massive network of specialized computers called <em>routers</em><code>路由器</code>. Each <em>router’s</em> job is to know how to move <em>packets</em> along from their source to their destination. A <em>packet</em> will have moved through multiple <em>routers</em> during its journey.</p>
<p>When a <em>packet</em> moves from one <em>router</em> to the next, it’s called a <em>hop</em>. You can use the command line-tool <code>traceroute</code> to see the list of hops packets take between you and a host.</p>
<p><img src="/images/How-does-the-internet-work/internet-1.png" class="lazyload" data-srcset="/images/How-does-the-internet-work/internet-1.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABAQMAAAAl21bKAAAABlBMVEXMzMyWlpYU2uzLAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAACklEQVQImWNgAAAAAgAB9HFkpgAAAABJRU5ErkJggg==" alt="Command-line utility traceroute showing all the hops between my computer and google’s servers"></p>
<blockquote>
<p>Command-line utility traceroute showing all the hops between my computer and google’s servers</p>
</blockquote>
<p>The <em>Internet Protocol</em> specifies how network <em>addresses</em> should be attached to the <em>packet’s</em> <em>headers,</em> a designated space in the <em>packet</em> containing its meta-data<code>原始数据</code>. The <em>Internet Protocol</em> also specifies how the <em>routers</em> should forward the <em>packets</em> based on the <em>address</em> in the <em>header</em>.</p>
<h3 id="Where-did-these-Internet-routers-come-from-Who-owns-them"><a href="#Where-did-these-Internet-routers-come-from-Who-owns-them" class="headerlink" title="Where did these Internet routers come from? Who owns them?"></a>Where did these Internet routers come from? Who owns them?</h3><p>These <em>routers</em> originated in the 1960s as <em>ARPANET</em>, a military<code>军事</code> project whose goal was a computer network that was decentralized so the government could access<code>访问</code> and distribute<code>分发</code> information in the case of a catastrophic<code>灾难性</code> event. Since then, a number of <em>Internet Service Providers</em> (ISP) corporations<code>公司</code> have added <em>routers</em> onto these <em>ARPANET</em> <em>routers</em>.</p>
<p>There is no single owner of these Internet <em>routers</em>, but rather multiple owners: The government agencies<code>代理商</code> and universities associated<code>关联</code> with <em>ARPANET</em> in the early days and <em>ISP</em> corporations like AT&amp;T and Verizon later on.</p>
<p>Asking who owns the Internet is like asking who owns all the telephone lines. No one entity owns them all; many different entities own parts of them.</p>
<h3 id="Do-the-packets-always-arrive-in-order-If-not-how-is-the-message-re-assembled"><a href="#Do-the-packets-always-arrive-in-order-If-not-how-is-the-message-re-assembled" class="headerlink" title="Do the packets always arrive in order? If not, how is the message re-assembled?"></a>Do the packets always arrive in order? If not, how is the message re-assembled?</h3><p>The <em>packets</em> may arrive at their destination out of order. This happens when a later <em>packet</em> finds a quicker path to the destination than an earlier one. But <em>packet’s header</em> contains information about the <em>packet’s</em> order relative to the entire <em>message</em>. The <em>Transport Control Protocol</em> uses this info for reconstructing<code>重构</code> the message at the destination.</p>
<h3 id="Do-packets-always-make-it-to-their-destination"><a href="#Do-packets-always-make-it-to-their-destination" class="headerlink" title="Do packets always make it to their destination?"></a>Do packets always make it to their destination?</h3><p>The <em>Internet Protocol</em> makes no guarantee <code>保证</code>that <em>packets</em> will always arrive at their destinations. When that happens, it’s called a <em>packet loss</em>. This typically happens when a <em>router</em> receives more <em>packets</em> it can process. It has no option other than to drop some <em>packets</em>.</p>
<p>However, the <em>Transport Control Protocol</em> handles <em>packet loss</em> by performing re-transmissions. It does this by having the destination computer periodically send acknowledgement <em>packets</em> back to the source computer indicating how much of the message it has received and reconstructed. If the destination computer finds there are missing <em>packets</em>, it sends a request to the source computer asking it to resend the missing <em>packets</em>.</p>
<p>When two computers are communicating through the <em>Transport Control Protocol,</em> we say there is a <em>TCP connection</em> between them.</p>
<h3 id="What-do-these-Internet-addresses-look-like"><a href="#What-do-these-Internet-addresses-look-like" class="headerlink" title="What do these Internet addresses look like?"></a>What do these Internet addresses look like?</h3><p>These <em>addresses</em> are called <em>IP addresses</em> and there are two standards.</p>
<p>The first address standard is called <em>IPv4</em> and it looks like <code>212.78.1.25</code> . But because <em>IPv4</em> supports only 2³² (about 4 billion) possible addresses, the <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Internet_Engineering_Task_Force"><em>Internet Task Force</em></a> proposed a new address standard called <em>IPv6</em>, which look like <code>3ffe:1893:3452:4:345:f345:f345:42fc</code> . <em>IPv6</em> supports 2¹²⁸ possible addresses, allowing for much more networked devices, which will be plenty more than the as of 2017 current 8+ billion networked devices on the Internet.</p>
<p>As such, there is a one-to-one mapping between <em>IPv4</em> and <em>IPv6</em> addresses. Note the switch from <em>IPv4</em> to <em>IPv6</em> is still in progress and will take a long time. As of 2014, Google revealed their <em>IPv6</em> traffic was only at 3%.</p>
<h3 id="How-can-there-be-over-8-billion-networked-devices-on-the-Internet-if-there-are-only-about-4-billion-IPv4-addresses"><a href="#How-can-there-be-over-8-billion-networked-devices-on-the-Internet-if-there-are-only-about-4-billion-IPv4-addresses" class="headerlink" title="How can there be over 8 billion networked devices on the Internet if there are only about 4 billion IPv4 addresses?"></a>How can there be over 8 billion networked devices on the Internet if there are only about 4 billion IPv4 addresses?</h3><p>It’s because there are <em>public</em> and <em>private IP addresses.</em> Multiple devices on a local network connected to the Internet will share the same <em>public IP address</em>. Within the local network, these devices are differentiated from each other by <em>private IP addresses</em>, typically of the form <code>192.168.xx</code> or <code>172.16.x.x</code> or <code>10.x.x.x</code> where <code>x</code> is a number between 1 and 255. These <em>private IP addresses</em> are assigned by <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Dynamic_Host_Configuration_Protocol"><em>Dynamic Host Configuration Protocol (DHCP)</em></a><em>.</em></p>
<p>For example, if a laptop and a smart phone on the same local network both make a request to <a target="_blank" rel="noopener" href="http://www.google.com/">www.google.com</a>, before the <em>packets</em> leave the modem, it modifies the <em>packet headers</em> and assigns one of its ports to that <em>packet</em>. When the google server responds to the requests, it sends data back to the modem at this specific port, so the modem will know whether to route the <em>packets</em> to the laptop or the smart phone.</p>
<p>In this sense, <em>IP addresses</em> aren’t specific to a computer, but more the connection which the computer connects to the Internet with. The address that is unique to your computer is the <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/MAC_address"><em>MAC address</em></a>, which never changes throughout the life of the computer.</p>
<p>This protocol of mapping <em>private IP addresses</em> to <em>public</em> <em>IP</em> <em>addresses</em> is called the <em>Network Address Translation</em> (NAT) protocol. It’s what makes it possible to support 8+ billion networked devices with only 4 billion possible <em>IPv4</em> addresses.</p>
<h3 id="How-does-the-router-know-where-to-send-a-packet-Does-it-need-to-know-where-all-the-IP-addresses-are-on-the-Internet"><a href="#How-does-the-router-know-where-to-send-a-packet-Does-it-need-to-know-where-all-the-IP-addresses-are-on-the-Internet" class="headerlink" title="How does the router know where to send a packet? Does it need to know where all the IP addresses are on the Internet?"></a>How does the router know where to send a packet? Does it need to know where all the IP addresses are on the Internet?</h3><p>Every <em>router</em> does not need to know where every <em>IP address</em> is. It only needs to know which one of its neighbors, called an <em>outbound link,</em> to route each packet to. Note that <em>IP Addresses</em> can be broken down into two parts, a n<em>etwork prefix</em> and a <em>host identifier</em>. For example, <code>129.42.13.69</code> can be broken down into</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Network Prefix: 129.42</span><br><span class="line">Host Identifier: 13.69</span><br></pre></td></tr></table></figure>

<p>All networked devices that connect to the Internet through a single connection (ie. college campus, a business, or ISP in metro area) will all share the same <em>network prefix</em>.</p>
<p>Routers will send all packets of the form <code>129.42.*.*</code> to the same location. So instead of keeping track of billions of <em>IP addresses</em>, <em>routers</em> only need to keep track of less than a million <em>network prefix</em>.</p>
<h3 id="But-a-router-still-needs-to-know-a-lot-of-network-prefixes-If-a-new-router-is-added-to-the-Internet-how-does-it-know-how-to-handle-packets-for-all-these-network-prefixes"><a href="#But-a-router-still-needs-to-know-a-lot-of-network-prefixes-If-a-new-router-is-added-to-the-Internet-how-does-it-know-how-to-handle-packets-for-all-these-network-prefixes" class="headerlink" title="But a router still needs to know a lot of network prefixes . If a new router is added to the Internet how does it know how to handle packets for all these network prefixes?"></a>But a router still needs to know a lot of network prefixes . If a new router is added to the Internet how does it know how to handle packets for all these network prefixes?</h3><p>A new <em>router</em> may come with a few preconfigured routes. But if it encounters a <em>packet</em> it does not know how to route, it queries one of its neighboring <em>routers</em>. If the neighbor knows how to route the <em>packet</em>, it sends that info back to the requesting <em>router</em>. The requesting <em>router</em> will save this info for future use. In this way, a new router builds up its own <em>routing table</em>, a database of <em>network prefixes</em> to <em>outbound links</em>. If the neighboring <em>router</em> does not know, it queries its neighbors and so on.</p>
<h3 id="How-do-networked-computers-figure-out-ip-addresses-based-on-domain-names"><a href="#How-do-networked-computers-figure-out-ip-addresses-based-on-domain-names" class="headerlink" title="How do networked computers figure out ip addresses based on domain names?"></a>How do networked computers figure out ip addresses based on domain names?</h3><p>We call looking up the <em>IP address</em> of a human-readable domain name like <code>www.google.com</code> “resolving the IP address”. Computers resolve IP addresses through the <em>Domain Name System</em> (<em>DNS</em>), a decentralized database of mappings from <em>domain names</em> to <em>IP addresses</em>.</p>
<p>To resolve an IP address, the computer first checks its local <em>DNS</em> cache, which stores the <em>IP address</em> of web sites it has visited recently. If it can’t find the <em>IP address</em> there or that <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Time_to_live#DNS_records"><em>IP address</em> record has expired</a>, it queries the <em>ISP’s</em> <em>DNS</em> servers which are dedicated to resolving IP addresses. If the <em>ISP’s</em> <em>DNS</em> servers can’t find resolve the <em>IP address</em>, they query the <a target="_blank" rel="noopener" href="https://www.iana.org/domains/root/servers"><em>root name servers</em></a>, which can resolve every domain name for a given <a target="_blank" rel="noopener" href="https://www.iana.org/domains/root/db"><em>top-level domain</em></a> . <em>Top-level domains</em> are the words to the right of the right-most period in a domain name. <code>.com</code> <code>.net</code> <code>.org</code> are some examples of <em>top-level domains</em>.</p>
<h3 id="How-do-applications-communicate-over-the-Internet"><a href="#How-do-applications-communicate-over-the-Internet" class="headerlink" title="How do applications communicate over the Internet?"></a>How do applications communicate over the Internet?</h3><p>Like many other complex engineering projects, the Internet is broken down into smaller independent components, which work together through well-defined interfaces. These components are called the <em>Internet Network Layers</em> and they consist of <em>Link Layer</em>, <em>Internet Layer</em>, <em>Transport Layer</em>, and <em>Application Layer</em>. These are called layers because they are built on top of each other; each layer uses the capabilities of the layers beneath it without worrying about its implementation details.</p>
<p><img src="/images/How-does-the-internet-work/internet-2.png" class="lazyload" data-srcset="/images/How-does-the-internet-work/internet-2.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABAQMAAAAl21bKAAAABlBMVEXMzMyWlpYU2uzLAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAACklEQVQImWNgAAAAAgAB9HFkpgAAAABJRU5ErkJggg=="></p>
<p>Internet applications work at the <em>Application Layer</em> and don’t need to worry about the details in the underlying layers. For example, an application connects to another application on the network via TCP using a construct called a <a target="_blank" rel="noopener" href="http://pubs.opengroup.org/onlinepubs/009695399/basedefs/sys/socket.h.html"><em>socket</em></a>, which abstracts away the gritty details of routing <em>packets</em> and re-assembling <em>packets</em> into <em>messages</em>.</p>
<h3 id="What-do-each-of-these-Internet-layers-do"><a href="#What-do-each-of-these-Internet-layers-do" class="headerlink" title="What do each of these Internet layers do?"></a>What do each of these Internet layers do?</h3><p>At the lowest level is the <em>Link Layer</em> which is the “physical layer” of the Internet. The <em>Link Layer</em> is concerned with transmitting data bits through some physical medium like fiber-optic cables or wifi radio signals.</p>
<p>On top of the <em>Link Layer</em> is the <em>Internet Layer</em>. The <em>Internet Layer</em> is concerned with routing packets to their destinations. The <em>Internet Protocol</em> mentioned earlier lives in this layer (hence the same name). The <em>Internet Protocol</em> dynamically adjusts and reroutes <em>packets</em> based on network load or outages. Note it does not guarantee <em>packets</em> always make it to their destination, it just tries the best it can.</p>
<p>On top of the <em>Internet Layer</em> is the <em>Transport Layer</em>. This layer is to compensate for the fact that data can be loss in the <em>Internet</em> and <em>Link</em> layers below. The <em>Transport Control Protocol</em> mentioned earlier lives at this layer, and it works primarily to re-assembly packets into their original <em>messages</em> and also re-transmit <em>packets</em> that were loss.</p>
<p>The <em>Application Layer</em> sits on top. This layer uses all the layers below to handle the complex details of moving the packets across the Internet. It lets applications easily make connections with other applications on the Internet with simple abstractions like <a target="_blank" rel="noopener" href="http://pubs.opengroup.org/onlinepubs/009695399/basedefs/sys/socket.h.html">sockets</a>. The <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol">HTTP protocol</a> which specifies how web browsers and web servers should interact lives in the <em>Application Layer</em>. The <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Internet_Message_Access_Protocol">IMAP protocol</a> which specifies how email clients should retrieve email lives in the <em>Application Layer</em>. The <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/File_Transfer_Protocol">FTP protocol</a> which specifies a file-transferring protocol between file-downloading clients and file-hosting servers lives in the <em>Application Layer</em>.</p>
<h3 id="What’s-a-client-versus-a-server"><a href="#What’s-a-client-versus-a-server" class="headerlink" title="What’s a client versus a server?"></a>What’s a client versus a server?</h3><p>While <em>clients</em> and <em>servers</em> are both applications that communicate over the Internet, <em>clients</em> are “closer to the user” in that they are more user-facing applications like web browsers, email clients, or smart phone apps. <em>Servers</em> are applications running on a remote computer which the <em>client</em> communicates over the Internet when it needs to.</p>
<p>A more formal definition is that the application that initiates a <em>TCP connection</em> is the <em>client</em>, while the application that receives the <em>TCP connection</em> is the <em>server</em>.</p>
<h3 id="How-can-sensitive-data-like-credit-cards-be-transmitted-securely-over-the-Internet"><a href="#How-can-sensitive-data-like-credit-cards-be-transmitted-securely-over-the-Internet" class="headerlink" title="How can sensitive data like credit cards be transmitted securely over the Internet?"></a>How can sensitive data like credit cards be transmitted securely over the Internet?</h3><p>In the early days of the Internet, it was enough to ensure that the network <em>routers</em> and links are in physically secure locations. But as the Internet grew in size, more <em>routers</em> meant more points of vulnerability. Furthermore, with the advent of wireless technologies like WiFi, hackers could intercept <em>packets</em> in the air; it was not enough to just ensure the network hardware was physically safe. The solution to this was <em>encryption</em> and <em>authentication</em> through <em>SSL/TLS</em>.</p>
<h3 id="What-is-SSL-TLS"><a href="#What-is-SSL-TLS" class="headerlink" title="What is SSL/TLS?"></a>What is SSL/TLS?</h3><p><em>SSL</em> stands for <em>Secured Sockets Layer.</em> <em>TLS</em> stands for <em>Transport Layer Security</em>. <em>SSL</em> was first developed by Netscape in 1994 but a later more secure version was devised and renamed <em>TLS</em>. We will refer to them together as <em>SSL/TLS</em>.</p>
<p><em>SSL/TLS</em> is an optional layer that sits between the <em>Transport Layer</em> and the <em>Application Layer</em>. It allows secure Internet communication of sensitive information through <em>encryption</em> and <em>authentication</em>.</p>
<p><em>Encryption</em> means the <em>client</em> can request that the <em>TCP connection</em> to the <em>server</em> be encrypted. This means all <em>messages</em> sent between <em>client</em> and <em>server</em> will be encrypted before breaking it into <em>packets</em>. If hackers intercept these <em>packets</em>, they would not be able to reconstruct the original <em>message</em>.</p>
<p><em>Authentication</em> means the <em>client</em> can trust that the <em>server</em> is who it claims to be. This protects against <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Man-in-the-middle_attack">man-in-the-middle attacks</a>, which is when a malicious party intercepts the connection between <em>client</em> and <em>server</em> to eavesdrop and tamper with their communication.</p>
<p>We see <em>SSL</em> in action whenever we visit SSL-enabled websites on modern browsers. When the browser requests a web site using the <code>https</code> protocol instead of <code>http</code>, it’s telling the web server it wants an <em>SSL</em> encrypted connection. If the web server supports <em>SSL</em>, a secure encrypted connection is made and we would see a lock icon next to the address bar on the browser.</p>
<p><img src="/images/How-does-the-internet-work/internet-3.png" class="lazyload" data-srcset="/images/How-does-the-internet-work/internet-3.png" srcset="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABAQMAAAAl21bKAAAABlBMVEXMzMyWlpYU2uzLAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAACklEQVQImWNgAAAAAgAB9HFkpgAAAABJRU5ErkJggg=="></p>
<blockquote>
<p>The medium.com web server is SSL-enabled. The browser can connect to it over https to ensure that communication is encrypted. The browser is also confident it is communicating with a real medium.com server, and not a man-in-the-middle.</p>
</blockquote>
<h3 id="How-does-SSL-authenticate-the-identity-of-a-server-and-encrypt-their-communication"><a href="#How-does-SSL-authenticate-the-identity-of-a-server-and-encrypt-their-communication" class="headerlink" title="How does SSL authenticate the identity of a server and encrypt their communication?"></a>How does SSL authenticate the identity of a server and encrypt their communication?</h3><p>It uses <em>asymmetric encryption</em> and <em>SSL certificates.</em></p>
<p><em>Asymmetric encryption</em> is an encryption scheme which uses a <em>public key</em> and a <em>private key.</em> These keys are basically just numbers derived from large primes. The <em>private key</em> is used to decrypt data and sign documents. The <em>public key</em> is used to encrypt data and verify signed documents. Unlike <em>symmetric encryption</em>, <em>asymmetric encryption</em> means the ability to encrypt does not automatically confer the ability to decrypt. It does this by using principles in <a target="_blank" rel="noopener" href="https://medium.com/@User3141592/notes-on-computational-cryptography-98db5f2908f1">a mathematical branch called number theory</a>.</p>
<p>An <em>SSL certificate</em> is a digital document that consists of a <em>public key</em> assigned to a web server. These <em>SSL certificates</em> are issued to the <em>server</em> by <a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Certificate_authority"><em>certificate authorities</em></a>. Operating systems, mobile devices, and browsers come with a database of some <em>certificate authorities</em> so it can verify <em>SSL certificates.</em></p>
<p>When a <em>client</em> requests an SSL-encrypted connection with a <em>server</em>, the <em>server</em> sends back its <em>SSL certificate</em>. The <em>client</em> checks that the <em>SSL certificate</em></p>
<ul>
<li>is issued to this <em>server</em></li>
<li>is signed by a trusted <em>certificate authority</em></li>
<li>has not expired.</li>
</ul>
<p>The <em>client</em> then uses the <em>SSL certificate’s public key</em> to encrypt a randomly generated <em>temporary secret key</em> and send it back to the <em>server</em>. Because the <em>server</em> has the corresponding <em>private key</em>, it can decrypt the client’s <em>temporary secret key</em>. Now both <em>client</em> and <em>server</em> know this <em>temporary secret key</em>, so they can both use it to symmetrically encrypt the <em>messages</em> they send to each other. They will discard this <em>temporary secret key</em> after their session is over.</p>
<h3 id="What-happens-if-a-hacker-intercepts-an-SSL-encrypted-session"><a href="#What-happens-if-a-hacker-intercepts-an-SSL-encrypted-session" class="headerlink" title="What happens if a hacker intercepts an SSL-encrypted session?"></a>What happens if a hacker intercepts an SSL-encrypted session?</h3><p>Suppose a hacker intercepted every <em>message</em> sent between the <em>client</em> and the <em>server</em>. The hacker sees the <em>SSL certificate</em> the <em>server</em> sends as well as the <em>client’s</em> encrypted <em>temporary secret key.</em> But because the hacker doesn’t have the <em>private key</em> it can’t decrypt the <em>temporarily secret key</em>. And because it doesn’t have the <em>temporary secret key</em>, it can’t decrypt any of the <em>messages</em> between the <em>client</em> and <em>server.</em></p>
<h3 id="Link"><a href="#Link" class="headerlink" title="Link"></a>Link</h3><p>下面是与本文相关的一些有趣的链接</p>
<ol>
<li><a target="_blank" rel="noopener" href="http://www.ietf.org/">http://www.ietf.org/</a> 是the Internet Engineering Task Force 的主页。这个组织主要负责互联网协议等相关项目开发。</li>
<li><a target="_blank" rel="noopener" href="http://www.internic.org/">http://www.internic.org/ </a>负责管理域名的一个组织。</li>
<li><a target="_blank" rel="noopener" href="http://www.nexor.com/public/rfc/index/rfc.html">http://www.nexor.com/public/rfc/index/rfc.html </a>是一个很好的RFC搜索引擎。</li>
<li><a target="_blank" rel="noopener" href="http://www.internetweather.com/">http://www.internetweather.com/</a>能够展示internet延迟动画图。</li>
<li><a target="_blank" rel="noopener" href="http://routes.clubnet.net/iw/">http://routes.clubnet.net/iw/</a>是来自ClubNET的Internet Weather。此页面显示各种运营商的数据包丢失。</li>
<li><a target="_blank" rel="noopener" href="http://navigators.com/isp.html">http://navigators.com/isp.html</a> 是Russ Haynal的ISP页面。这是一个很棒的站点，具有指向大多数NSP及其骨干基础结构图的链接。</li>
</ol>
<h3 id="Bibliography"><a href="#Bibliography" class="headerlink" title="Bibliography"></a>Bibliography</h3><ul>
<li>TCP/IP Illustrated, Volume 1, The Protocols.<br>W. Richard Stevens.<br>Addison-Wesley, Reading, Massachusetts. 1994.</li>
<li>Encyclopedia of Networking.<br>Tom Sheldon.<br>Osbourne McGraw-Hill, New York. 1998.</li>
</ul>

            </div>
            
    <div class="post__license">
        <p>
            <strong>Author: </strong>叶苏雄
        </p>
        <p>
            <strong>
                Permalink: 
            </strong>
            <a href="https://yesux.github.io/2020/09/14/How-does-the-internet-work/">https://yesux.github.io/2020/09/14/How-does-the-internet-work/</a>
        </p>
        
            <strong>
                <p>文章默认使用 <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">CC BY-NC-SA 4.0</a> 协议进行许可，使用时请注意遵守协议。</p>

            </strong>
        
    </div>
 
            <div class="post-footer__meta">
    <p>
        updated at 2020-09-15
    </p>
</div> 
            <div class="post-meta__cats">
    
    
        <a href="/tags/Internet/" class="post-tags__link button"># Internet</a>
    
</div> 
        </article>
        
    </div>


</main>

            <footer class="footer">
    


    
     
 

 
    
        
        <p class="footer-copyright">
            Copyright&nbsp;©&nbsp;2020&nbsp;<a href="/">博客</a>
        </p>
    
    
    <p>Powered by <a href="https://hexo.io" target="_blank">Hexo</a> | Theme - <a href="https://github.com/ChrAlpha/hexo-theme-cards" target="_blank">Cards</a></p>
</footer>

        </div>
        
    <script defer src="https://cdn.jsdelivr.net/npm/vanilla-lazyload@17.1.0/dist/lazyload.min.js"></script>
    <script>
        window.lazyLoadOptions = {
            elements_selector: ".lazyload",
            threshold: 0
        };
    </script>
 

 

 

 

  



 


    



    
<script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js"></script>

    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.4.1/dist/jquery.fancybox.min.css">

    
<script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.4.1/dist/jquery.fancybox.min.js"></script>

    <script>
        let lazyloadT = Boolean('[object Object]'),
            auto_fancybox = Boolean('false')
        if (auto_fancybox) {
            $(".post__content").find('img').each(function () {
                var element = document.createElement("a");
                $(element).attr("data-fancybox", "gallery");
                $(element).attr("href", $(this).attr("src"));
                if (lazyloadT) {
                    $(element).attr("href", $(this).attr("data-srcset"));
                }
                $(this).wrap(element);
            });
        } else {
            $(".post__content").find("fancybox").find('img').each(function () {
                var element = document.createElement("a");
                $(element).attr("data-fancybox", "gallery");
                $(element).attr("href", $(this).attr("src"));
                if (lazyloadT) {
                    $(element).attr("href", $(this).attr("data-srcset"));
                }
                $(this).wrap(element);
            });
        }
    </script>
 

 
    <script defer src="/js/b2t.js"></script>







    </body>
</html>
